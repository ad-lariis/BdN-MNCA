#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Created on Thu Nov 30 10:40:05 2023

@author: alexandre
"""


import numpy as np
import pandas as pd
import requests
from shapely.geometry import Point
import shapely.wkt




def main(list_grp):
    #polygone MNCA
    poly_mnca = 'MULTIPOLYGON (((7.41248321254425 43.73159875677341, 7.409302560481033 43.732500096438805, 7.401964762303472 43.730904660146024, 7.398277664922914 43.73094294889727, 7.39285802680704 43.7285050982977, 7.392614759412033 43.727263106706516, 7.391576878262361 43.72729329833593, 7.391870672237853 43.726636152925956, 7.390202917513033 43.72645834281192, 7.391200669530607 43.728722522994076, 7.389807904972478 43.731157096219626, 7.391859059422995 43.733348124926536, 7.38760018105532 43.740160294864296, 7.381365799733356 43.736973326528975, 7.3768501335687 43.73556081446919, 7.374452305475572 43.73604568682612, 7.375324065769378 43.7374652142038, 7.375424285927219 43.74446195234318, 7.378003456307965 43.7450097990445, 7.378696207163065 43.74439702090519, 7.381422303696272 43.74694322941047, 7.384717038927891 43.747498159072286, 7.384626276227906 43.748876210278276, 7.386174402085541 43.750468501414375, 7.385180271190756 43.75396033477892, 7.387446192411976 43.75644657121367, 7.390367146425588 43.757744636883466, 7.385131561572511 43.76182027724999, 7.379262216034194 43.760181104410485, 7.372145257736674 43.7612630359716, 7.370182575777683 43.76029732455886, 7.366167430511936 43.76094874714826, 7.364850296241468 43.76045632983183, 7.364425333785172 43.759026888572656, 7.362769044973003 43.75905904913138, 7.360592857397838 43.755307015133425, 7.359747393872623 43.75589424419974, 7.360191574959694 43.75801777503809, 7.359603457471837 43.7590453079661, 7.362661311500553 43.761737332112, 7.362436697625532 43.762998152100316, 7.352421577854179 43.764127297232726, 7.35046221589874 43.76553854922063, 7.349056299095925 43.76474487379986, 7.347272085575375 43.765206381639864, 7.344793216776124 43.76379310099819, 7.340762214382503 43.76591229432055, 7.337797372702603 43.765188747807706, 7.334494008765432 43.76760944559799, 7.331209592553468 43.768708092791044, 7.332373793321075 43.770055952733344, 7.332270350667803 43.77161197383191, 7.331637338538337 43.77166149715155, 7.328048936144149 43.769258281371634, 7.329484469989396 43.76776915824826, 7.326679005079916 43.76773741367253, 7.324151693613792 43.76646709321905, 7.317879711267765 43.75927930057473, 7.311073389138535 43.760153821234724, 7.309566990842522 43.75859492166409, 7.311048464875235 43.75738271200793, 7.310461602301399 43.75698689869258, 7.311193481491167 43.755843124251584, 7.309158900090828 43.755885852312076, 7.309110954774233 43.75379787200534, 7.302104391824916 43.753705587973755, 7.299469414669614 43.754740651883424, 7.295260097950549 43.75981114767582, 7.294906848184921 43.764559959331656, 7.295516129470263 43.76800191782691, 7.299478851476784 43.77244249750264, 7.29619521547864 43.77477106528536, 7.296249395772376 43.77593868743176, 7.291784024362057 43.77747472277883, 7.303828381289554 43.78105379449262, 7.310081313527986 43.781120062962906, 7.31285574732809 43.78193574545593, 7.317383216311692 43.785225105492735, 7.317166373387662 43.78657021432071, 7.314222223528994 43.78830549634108, 7.314111280302627 43.79108745625609, 7.309918898831735 43.79306942410654, 7.307979020228229 43.792818137938205, 7.307159717117486 43.79589576764479, 7.304769956189896 43.798955270183974, 7.302250786616436 43.798762818466756, 7.302636123373717 43.79973262898701, 7.30126817760235 43.80212262394197, 7.30300937273804 43.80376346547115, 7.303003361188336 43.80665753103766, 7.300862564296411 43.80804074384269, 7.300876034437574 43.81000488064012, 7.302025070157774 43.81095175689435, 7.30016421566107 43.812104898860454, 7.302116098767173 43.815052350438485, 7.298432051518581 43.81819435359363, 7.29806995118958 43.8201805268004, 7.301107942428215 43.82187841788017, 7.301109468241581 43.82371687107, 7.295050715990885 43.82361250770365, 7.29298443283138 43.82160940330905, 7.290680961668178 43.820705189264515, 7.293553121929739 43.81745127011214, 7.288086218589593 43.81620210194988, 7.289077830044609 43.81453996863328, 7.285754676715984 43.813194560078465, 7.285150101198974 43.81532178464621, 7.280641856220668 43.816546233422116, 7.280773791823777 43.8134075245994, 7.277879604792675 43.81386457682573, 7.277179687090108 43.81500505688292, 7.276272844035704 43.81429625594053, 7.271452813857519 43.81737733480266, 7.269435474836501 43.82037723280391, 7.270166989044094 43.82158773098499, 7.266920345667464 43.82224844354273, 7.268096346447481 43.82334421727813, 7.276544101852112 43.825067744836794, 7.27331563771767 43.8341750550915, 7.27430254086986 43.840507100385224, 7.272276621184739 43.84471594867069, 7.273042095232715 43.851266714126744, 7.272563434327146 43.85698486662238, 7.273105439523168 43.85966642569563, 7.272103225181588 43.86714451019625, 7.272837769495827 43.868736156919056, 7.272695174988225 43.87127423093041, 7.278359992357575 43.87401811765035, 7.282769901345819 43.87776364849741, 7.284821827219766 43.87852481729824, 7.285212915782081 43.88140968598094, 7.287380488373667 43.8854819967763, 7.291938230885296 43.88703136247219, 7.299754978029037 43.886016904064654, 7.304762268970706 43.88692885474061, 7.306132947785056 43.886283515698004, 7.306183627042503 43.887202613473015, 7.308395608901764 43.887087322193345, 7.309042139999745 43.8878431855026, 7.308286907183156 43.88899780763976, 7.309386807107797 43.8896014727189, 7.308843491499288 43.891384026761564, 7.30755251780863 43.891765782434526, 7.30812218180371 43.89465530589377, 7.309136542176848 43.894702664923926, 7.30928305777512 43.895866734996446, 7.314819161671335 43.896752872968975, 7.307576621027999 43.90114622100955, 7.307162390372713 43.902610030427226, 7.307805852614727 43.90494057372704, 7.306798053582139 43.90532915592086, 7.306736946903154 43.90626980190497, 7.306968513631951 43.909105108789404, 7.308193476641041 43.910039149158635, 7.307878299483486 43.913029439152986, 7.308690738985006 43.91488826234263, 7.309991337943115 43.91505591391634, 7.31281870949018 43.91358415968219, 7.314551173464977 43.91583469474687, 7.309386077605705 43.9184470333094, 7.307001169138381 43.91826989618062, 7.304247550813253 43.92047583321073, 7.303512302540446 43.9242812269379, 7.299020721964895 43.92739103000222, 7.297801143132374 43.93060077865129, 7.29256471807653 43.93585404150467, 7.291154120643403 43.93850521168779, 7.29122214998662 43.939988764207556, 7.294176562133877 43.94173736713024, 7.298464168152718 43.94063489420764, 7.299553676556599 43.93963391399725, 7.302292055312427 43.93987212843983, 7.30257039314209 43.94200624729945, 7.305710626033262 43.943962646030876, 7.309909910019397 43.943325572280216, 7.312795024606478 43.94012557261675, 7.315947033543145 43.940010018385664, 7.317480966052949 43.94061542989758, 7.317646514540324 43.94151649886039, 7.31923720499057 43.942079986276866, 7.320259879080457 43.943970126585526, 7.322344466625724 43.94532070245255, 7.322574652639839 43.94884924412451, 7.330331708796714 43.947648663385294, 7.333823141340604 43.949169464383395, 7.340384602724797 43.948488808594576, 7.349830041570778 43.94429127380263, 7.358286291776392 43.94386299115443, 7.360695759382474 43.94227326500159, 7.362978638625951 43.94320326859686, 7.364993885627297 43.94291810889465, 7.365516337855605 43.940358151005604, 7.369763538026818 43.93968888385107, 7.368121921015972 43.9432689040483, 7.36925030284841 43.94510034260933, 7.369143939074854 43.94792760345834, 7.37589874324375 43.95440097711548, 7.376101807566828 43.956606558386774, 7.377597288191202 43.95897035610359, 7.380275397345475 43.96741505070452, 7.384854665732193 43.970841260192046, 7.387598198589833 43.97089332978521, 7.391217140752548 43.97326722106536, 7.392454016323595 43.97592160394039, 7.391158295336087 43.97982256189283, 7.392035557155429 43.981502610676785, 7.395904442900068 43.98377170233966, 7.397786493570833 43.98657857084189, 7.401087311482732 43.98867837854038, 7.406141530471238 43.98907048083651, 7.409474489346227 43.99396578011782, 7.416964726156964 43.99676495726325, 7.422615268911677 43.99617403588893, 7.425162623028161 43.997058840815676, 7.427203742614211 43.99959023935708, 7.433477350836364 44.00098456604242, 7.430911404349561 44.00695773132109, 7.426348620580697 44.01107909129189, 7.422569126921544 44.0165125595635, 7.411982658500515 44.02190713481329, 7.412445243082278 44.02349117001451, 7.416234431099562 44.02682662964256, 7.42086888729862 44.02905511870162, 7.423072392028646 44.03118799489711, 7.423036904227371 44.03468604439291, 7.424058426935821 44.038423485662776, 7.422863675203952 44.0388395989166, 7.420827672496539 44.04259793916739, 7.418563708971927 44.04455088084971, 7.421485642631449 44.0465944034224, 7.42311521107225 44.049229189194214, 7.427348837761305 44.051130279855705, 7.428596891266166 44.05256801916107, 7.426090243750888 44.05885783793145, 7.42809066881092 44.06032374257849, 7.427937205078864 44.06156402444325, 7.426007206955309 44.063509911541914, 7.426274380486826 44.06573827708517, 7.427500630646708 44.06716521582757, 7.426918527513152 44.06911515336942, 7.42901198894599 44.070502480490944, 7.426762707036871 44.07458240251078, 7.427611321993802 44.075573008561655, 7.426487620804449 44.0771365088533, 7.427382972019488 44.07842180478215, 7.426417972445558 44.080289882243655, 7.429898215855139 44.081719369443114, 7.432228772735027 44.08551566664386, 7.431958503908938 44.08678143634551, 7.429506255040395 44.08811751401185, 7.428873038530113 44.08983066200492, 7.426877164111826 44.09145650271867, 7.427204934247572 44.09415571959946, 7.426125126879959 44.09527572855063, 7.43174013664599 44.09821173724818, 7.432376866080601 44.10008893826295, 7.431424652062096 44.1015139385804, 7.432317974481686 44.102686630688176, 7.430552661140248 44.104129217808016, 7.429560842510247 44.109060690161066, 7.427154549361576 44.109682675543084, 7.426856613211784 44.11094955888602, 7.428329445177177 44.11255770350106, 7.427182563687195 44.11304580300069, 7.4250611613647 44.11218683179382, 7.422230455054618 44.11271137002309, 7.419693402850017 44.11485652277094, 7.416648688272625 44.116123335951336, 7.415748396123511 44.11704938754494, 7.415827369493027 44.118291117344, 7.41445502970792 44.11914965327374, 7.409033828893118 44.11983863813321, 7.406340898188054 44.11816035670996, 7.404762244469955 44.11850602831396, 7.393145135195301 44.12543610888839, 7.391469165160033 44.12450993547373, 7.389155376038147 44.125159791195074, 7.387862547984607 44.12413797988514, 7.382870744726601 44.122939747481134, 7.368906474262441 44.11680554235587, 7.364428374217133 44.11765478996236, 7.361310088887753 44.11641428109302, 7.357702658147498 44.11620094713498, 7.356812501972992 44.11710804437978, 7.356644842629458 44.11991543273135, 7.354409376243269 44.125067639554786, 7.352150089342513 44.126009294634, 7.34778470820076 44.13539252125218, 7.345652341042625 44.13662555728392, 7.346734320322438 44.13803932722489, 7.345748458615779 44.14347798444662, 7.344662841112877 44.14524186960867, 7.34231641454546 44.14607136723941, 7.340605151563969 44.14535133862773, 7.334615573582872 44.14516212266045, 7.332694746558356 44.143908514886355, 7.328133575142151 44.144867641530666, 7.319860706695275 44.14312994517217, 7.317087678428135 44.143406022186106, 7.310045859678667 44.147722500591584, 7.308018128739937 44.14404610265421, 7.303437936077639 44.146212811278666, 7.295371127658252 44.14416142299013, 7.293128844605402 44.14566450806936, 7.28789760487849 44.14525193006725, 7.285843942451542 44.14247218205683, 7.282380231835875 44.14081027419909, 7.280490905358066 44.14088682094337, 7.278140762384126 44.14352053169011, 7.274099655631607 44.145295351338206, 7.272098997861132 44.14763856074924, 7.262372148832378 44.1481562293461, 7.260337101602616 44.15051586625132, 7.25922075400541 44.153592403450354, 7.257015714880439 44.15530868728306, 7.251989089218131 44.15599691338783, 7.249268178831586 44.15795118039134, 7.246992650375421 44.16259854566618, 7.245374007935409 44.163541905861074, 7.245081840614404 44.165881473991604, 7.243106136696051 44.16846651001404, 7.243588918949762 44.171675645532645, 7.241767652623505 44.17316310845528, 7.238275332310233 44.17369120429712, 7.235202070367669 44.17553973173517, 7.235170453030758 44.174595412843054, 7.233487873551315 44.17418448812709, 7.232864879096756 44.1714557622615, 7.231900134483637 44.171550703757525, 7.228924040338367 44.169105689598574, 7.229135152127967 44.16852697855062, 7.224577963741103 44.16913088168053, 7.220778364641237 44.16826955059773, 7.21894286055004 44.16862775665783, 7.21846341001133 44.1699279460411, 7.215944926600033 44.17097217958371, 7.214074173843374 44.17527780794791, 7.204803717330103 44.17913198214707, 7.204842123735016 44.18240694307624, 7.203697073544061 44.18480610554377, 7.200605538295284 44.18729337151537, 7.197326298042173 44.186331028097165, 7.193601772998365 44.18719013421094, 7.193696231454425 44.1898590364374, 7.188413289350426 44.19761432147474, 7.1890744965451 44.19874730620611, 7.188397026569135 44.2008742460292, 7.18609967871254 44.20135766179086, 7.18314114506379 44.19900805963471, 7.177543364952789 44.197189815050635, 7.17507592034561 44.20050340428625, 7.167489932054718 44.20243871477271, 7.165732508512486 44.20640560484242, 7.163178967679027 44.20821872696586, 7.156333308898081 44.203822043796464, 7.149564335332097 44.20234420478342, 7.148359235029063 44.20121626138776, 7.148467480469434 44.200160311474555, 7.14279936641703 44.200246598390954, 7.138239258820786 44.20267569654506, 7.136944061750072 44.20434785255364, 7.130371619785033 44.20721572767508, 7.125353392651423 44.211562400007104, 7.120870607429888 44.21247269823355, 7.119052755805795 44.215016908065124, 7.113635937065644 44.217862850424844, 7.110115117058141 44.21735579063822, 7.108713846290566 44.21823659494185, 7.107158291757677 44.21809475486027, 7.10009127983879 44.2214614387008, 7.09825326490803 44.22053326629443, 7.094631014360425 44.22122553541722, 7.092300809768843 44.22019666426418, 7.090665680814932 44.22227116974877, 7.090468163800873 44.2247814683427, 7.08637641244426 44.22915747707149, 7.07625905113752 44.23225665706754, 7.068684115420213 44.23259277966843, 7.065068623964719 44.2299832346457, 7.064898587061855 44.228712397580054, 7.065735869675397 44.22841459091761, 7.062539907511439 44.226861974606074, 7.056042163997369 44.229491699319986, 7.044245423414492 44.226322917471144, 7.038523858641335 44.22371987847713, 7.032839686426683 44.2254259858253, 7.030998833693607 44.22791806539851, 7.030330277772295 44.2316162268122, 7.026476086589378 44.231108808284624, 7.024199819863445 44.23229367017854, 7.023473720538948 44.234074175461465, 7.022023809335875 44.23445178749075, 7.01928545286632 44.23237374962011, 7.017142937506127 44.23226384231758, 7.015002594016372 44.23289285415155, 7.012279817959193 44.235283468668555, 7.008447279568526 44.235207229129614, 7.00431477173965 44.241624601027894, 7.000711251711406 44.243734299222155, 7.000907434778914 44.247119513165565, 6.998266454396517 44.24834053087972, 6.997702542094831 44.251315422036264, 6.996529970380623 44.25193583319445, 6.998439279805242 44.25911430636504, 6.996518421438492 44.26397720992666, 6.99516732072356 44.26518271532621, 6.996249937539277 44.266378058210464, 6.995439053629838 44.26953678965578, 6.99736167614742 44.273304443099995, 6.99449920831667 44.27741748490253, 6.994780750008161 44.279543270691, 6.995834191569326 44.2802142515224, 6.993349166913611 44.28091210312163, 6.989591080350024 44.28343346781875, 6.983297684586538 44.284875919117134, 6.981205574394448 44.28711753487191, 6.979366306141346 44.286994020337424, 6.971705911786342 44.28365631400205, 6.968672159084753 44.28686182867647, 6.970759435023022 44.289683963859424, 6.971554788567703 44.293334191041, 6.96726709104924 44.29546741698562, 6.963941503526619 44.29447801211662, 6.963310350257867 44.29356346924207, 6.960116797793212 44.2939400144387, 6.957307264166624 44.29535981312418, 6.95572031136202 44.29750519700806, 6.956670612671959 44.29792340800712, 6.956635852995312 44.29961813559693, 6.958442283934063 44.30120688351974, 6.957716751373142 44.305229240460115, 6.959859833926455 44.30696267068199, 6.960701753614318 44.30886194436415, 6.960189444685914 44.31146255286127, 6.953965015138397 44.315331443480105, 6.952755564237487 44.31942436215864, 6.944881618046431 44.32118807363201, 6.942956384248109 44.32399160760099, 6.941513695570952 44.32476527104708, 6.938314233048494 44.32459606686801, 6.93696259389906 44.328847993532506, 6.935027393622332 44.330107864109856, 6.933401620611567 44.33003897675173, 6.926771775504637 44.332841919395676, 6.925608057789232 44.338316295744626, 6.924165282033196 44.339568289370106, 6.9241363299315 44.34098070180605, 6.921515696705057 44.342798328126726, 6.920883742778789 44.34471712577728, 6.922842792994564 44.348013470729484, 6.922002154834846 44.35163410599692, 6.918315766958143 44.35308858913161, 6.911786611349302 44.35319848186756, 6.909319531987052 44.35648930221703, 6.905548230343403 44.35839698711586, 6.899532012017908 44.357427132939605, 6.898994665077712 44.35830688640135, 6.887427465725822 44.36128675587035, 6.883502762328364 44.3595634329614, 6.877337359139942 44.35470516817109, 6.871540931262158 44.352802295886924, 6.864619529794507 44.34751398868432, 6.860824692494767 44.34604942200415, 6.859306197566441 44.344094793742606, 6.855901247952388 44.34296516034722, 6.851596628637899 44.345998161677166, 6.845915524506999 44.345599515398455, 6.840080549739335 44.34657850926257, 6.837163718660959 44.342825836921406, 6.831873775772912 44.34044367912381, 6.830500652478973 44.338096111188314, 6.822398107157795 44.33265277475983, 6.815505810800476 44.331937849155516, 6.812470436237109 44.33263615317251, 6.808420703569555 44.33001436761085, 6.807912167457668 44.32751134643634, 6.806062050623963 44.3256306532617, 6.807275146471754 44.32135934965721, 6.799112153806474 44.31864988718192, 6.799506219275595 44.318068517857526, 6.796517019997666 44.31645056231815, 6.795311279865404 44.31424736732248, 6.794595129126006 44.307322208122045, 6.795934623762884 44.30472470860538, 6.796367199030585 44.29851958744676, 6.790189057303161 44.294756037623635, 6.786449638352354 44.28971770197385, 6.78655726864717 44.28794861023241, 6.788357621338808 44.28543446394984, 6.788041710024366 44.28297887489271, 6.788908359774137 44.28001119125133, 6.788038986303641 44.2783956593143, 6.788332013358713 44.276436341560945, 6.78985616082555 44.274581433868164, 6.790276286954112 44.27234827862854, 6.792987825554797 44.27079117040858, 6.794769719874242 44.26621479484151, 6.794512530235864 44.26280288618139, 6.795811610741291 44.260048201727834, 6.801364074857696 44.25879452833375, 6.801607853673507 44.2571189427236, 6.798069107082704 44.25342683055302, 6.796643217274497 44.24870274400985, 6.798343717948359 44.245771040209625, 6.806514536360261 44.24408398489633, 6.807715436566782 44.24169301753024, 6.807816772869649 44.2388517657218, 6.805780973618583 44.236719962761896, 6.804922623428969 44.232836929247554, 6.8061185936308 44.23211238364844, 6.807039696655657 44.22856234381666, 6.809150273941577 44.22658496926437, 6.810164968660127 44.220905846889664, 6.811871358116931 44.22030408408905, 6.815163604223703 44.216657147760486, 6.822903488774368 44.21541176765266, 6.824986291139454 44.21073248084591, 6.827796175040356 44.20795984976554, 6.82795458349268 44.20601774919037, 6.832152516576338 44.203547996860344, 6.835134953590806 44.19935342553551, 6.836615622154776 44.19885376678791, 6.836668230514384 44.19727851626142, 6.838324968999773 44.196104919659646, 6.845922935971812 44.195418793808734, 6.851363692021749 44.19166558118363, 6.853861759252855 44.1923203721856, 6.856228461484613 44.18919666283461, 6.862362061026125 44.18883480264606, 6.870927955753078 44.184783000887855, 6.873181066899478 44.18450968358211, 6.873522407367123 44.18064694887088, 6.874943136761431 44.177427352253645, 6.874375494749169 44.176705757305754, 6.877774608120056 44.17200406563078, 6.882798434153599 44.178493966523504, 6.886105085295431 44.18104877788616, 6.889716816539064 44.18183719433244, 6.891429321786785 44.18520810072984, 6.8982316727853 44.18882982846471, 6.904169569676934 44.19037768328849, 6.907808302872995 44.18956226522339, 6.91041813010691 44.19010276111643, 6.911711777687897 44.189209502157546, 6.915169370803637 44.18956553595534, 6.919350481639863 44.18808240283858, 6.925652580308197 44.18849500484115, 6.928315764963551 44.1872704252494, 6.933528321779781 44.19032337170691, 6.937830392604193 44.19080611336926, 6.945821515238109 44.194463445975195, 6.946519261280478 44.195436879939486, 6.950568628639215 44.196690662929164, 6.950914121745813 44.194887502930065, 6.956565039893673 44.189033139282216, 6.958552145078608 44.181426368933074, 6.962953178137904 44.17481018222769, 6.962708350602714 44.16762377321809, 6.961734957096691 44.16679019593421, 6.96297238007668 44.165701864417294, 6.9618509766606 44.161777099004134, 6.969458247104791 44.15827551525598, 6.978841578948193 44.15846515744644, 6.979755480549687 44.15934129823611, 6.9882625547315 44.15464311193457, 6.988164774270397 44.153232662174005, 6.994080440456864 44.147374678742366, 6.993348376650077 44.140681905712974, 6.994238435420049 44.13753486856707, 6.993310331788204 44.136615221571674, 6.994010402542176 44.13279560433578, 6.996335402366024 44.131586999011134, 6.99718050038186 44.13002861265044, 7.000584724042719 44.1297385118929, 7.00292760405418 44.12772161965302, 7.005068365141965 44.127916431548165, 7.005225021957316 44.12618037380543, 7.00600312825904 44.12569950876457, 7.00430086679063 44.12306172561023, 7.007261562907049 44.11856363919563, 7.00636613648479 44.117076960568724, 7.010130209702904 44.11711132434935, 7.013503368366658 44.11478068462454, 7.01615769740258 44.1145842373355, 7.016701990404107 44.11253293927055, 7.01964707962588 44.10880830076255, 7.024711432143826 44.10954872041225, 7.028332896084859 44.1077005326427, 7.027773819017462 44.10498230330837, 7.025856643767307 44.103819050836314, 7.020369632541748 44.09705973032126, 7.021554723967983 44.09468477854864, 7.020989656399329 44.09148642812688, 7.02203425778911 44.091104692256984, 7.023604881379325 44.084656528041315, 7.020386586280976 44.0773687310324, 7.022759296981508 44.07586665808301, 7.026026003809014 44.07117294220818, 7.027459740589681 44.067430678628334, 7.028974050608052 44.06641695718785, 7.031264387035206 44.06513760947163, 7.036458315807934 44.064391883503326, 7.037347301901872 44.0629000394809, 7.040468244650535 44.06126630431756, 7.042849990726776 44.06082234432743, 7.046793290016775 44.06144168129069, 7.048261547728818 44.05957684101733, 7.054039191581116 44.05591307587192, 7.054858819996494 44.05286005252269, 7.052545558878686 44.05132991598782, 7.050731541067325 44.04887734474127, 7.052822138028943 44.044599405572626, 7.055871417611367 44.04357525972604, 7.059372425491797 44.040495740012865, 7.059187967385038 44.0366310266959, 7.057151492010421 44.033017993001195, 7.057938949163399 44.03032663938944, 7.059593190842734 44.02831865351286, 7.053749619582983 44.02634735231404, 7.052667894902017 44.02220592942102, 7.058635397916987 44.0174434680604, 7.063901663650689 44.009693149419505, 7.068437206382028 44.00630898566682, 7.070778540581734 44.0055089708912, 7.070125210884115 44.002866680056094, 7.072520214611226 44.00091650881677, 7.074519363610512 43.995424948646374, 7.078553421234002 43.995032949573975, 7.083843706178802 43.99250579887698, 7.09363384396409 43.991564525216305, 7.099658188798907 43.98887840087231, 7.101013914790345 43.98560393740541, 7.100835763522527 43.98380552425106, 7.10745041461132 43.97786327811711, 7.107843741848527 43.974266228896525, 7.110815195590157 43.97402648299131, 7.11171053669097 43.97278968733647, 7.111768390588036 43.96470378034132, 7.109688928716017 43.96221905120855, 7.110930058427304 43.961263942076194, 7.115345353305241 43.961124698973805, 7.117220689489829 43.95955533284567, 7.120191411974143 43.959299109837154, 7.121141628659291 43.95786099657579, 7.12373286701491 43.95901675072973, 7.125233204058766 43.95832023897469, 7.126823980439912 43.95870082634402, 7.128158079351543 43.957380615534845, 7.13091579847191 43.95843888923723, 7.134083524589254 43.956032672208295, 7.135519637115495 43.953920851837175, 7.141368113951801 43.95131462522022, 7.140731428064899 43.949110093000314, 7.142782123575764 43.94746241288351, 7.143965376071889 43.944521946851864, 7.145707632297289 43.943833077039685, 7.145785059103771 43.942222391181176, 7.147124652474465 43.94050879749968, 7.145819062941436 43.93660211181809, 7.149008784612662 43.933991817945966, 7.153980247978343 43.933453090637585, 7.153854823927247 43.93294688141225, 7.156249108419697 43.93241596168019, 7.159609443061831 43.92914546857167, 7.160298003075975 43.92672202616038, 7.16793614581765 43.92529961815, 7.166780062724718 43.92345392964274, 7.166390870812145 43.91923673417844, 7.169137505875917 43.91940761420339, 7.173651214915798 43.916602671254765, 7.175695288314844 43.91434806624012, 7.185623864383093 43.91127579001993, 7.187670898440032 43.909902212634364, 7.188733953566899 43.907573237578085, 7.190427713496032 43.90797683393693, 7.192991180034569 43.91029090577763, 7.195076608567615 43.90788291553015, 7.195845531289328 43.90377986726645, 7.191284369742985 43.90329909428917, 7.190873519475899 43.90201623464633, 7.188064338726929 43.90061007642973, 7.190729895736647 43.89665146150579, 7.190277503610444 43.89546392809302, 7.187767500138895 43.893833605017775, 7.188824445662415 43.89142556880053, 7.187800317416766 43.88857654476406, 7.190154082755879 43.88448573070409, 7.188349251641908 43.87943625886981, 7.189245653139317 43.87825641270055, 7.18829876707306 43.876338092376635, 7.182813580803023 43.87499856370728, 7.175771418567068 43.87500348777784, 7.174226630107493 43.87169941418184, 7.170601630150434 43.870489947778715, 7.168621151304349 43.86883811785946, 7.165552619565524 43.86845612878835, 7.166246132230481 43.86703551716988, 7.161234422968317 43.866036440824345, 7.159504105144713 43.86493995172855, 7.159415062146246 43.862880574292, 7.157990977312997 43.862754657072884, 7.15639664402944 43.86141953941313, 7.153303912478457 43.86244396341721, 7.152700457815906 43.861801889930774, 7.149589439097275 43.8619419614809, 7.142501354168234 43.86314328493549, 7.139907609742091 43.86200180524113, 7.138040037535346 43.863505535111614, 7.135314519321792 43.863225946371855, 7.134679788898486 43.86438456937628, 7.130784188810865 43.86234242182794, 7.127706725031724 43.85948518052311, 7.126801482542328 43.859677148455795, 7.125352221273098 43.854168330341274, 7.128191315951078 43.85132408889038, 7.127990094000888 43.84957448176623, 7.129995465247648 43.845640737972325, 7.133372194449696 43.846568885983416, 7.134661149498171 43.8461937886855, 7.137106909334177 43.84453119745122, 7.138142875630413 43.84259045874098, 7.142082642303065 43.841119733790244, 7.143428145352554 43.838111935900926, 7.144505490680622 43.83748342708827, 7.145030029346698 43.835671102937916, 7.143562566178701 43.83323885082424, 7.13990911866331 43.830391323284395, 7.140992860484284 43.82890832632592, 7.140606613715091 43.82790742143637, 7.142151714715695 43.824205404747445, 7.145394723409319 43.822070739096596, 7.144235913964749 43.81966823786795, 7.145766552693176 43.818568295698405, 7.151223389228226 43.819126489474996, 7.157323918673738 43.81852351538387, 7.161305389746642 43.81924292784608, 7.160885628592811 43.81840106993649, 7.155056553087895 43.81376998990774, 7.147922400802241 43.811802530894695, 7.140504576352076 43.80689241896215, 7.136285465614756 43.80545231147624, 7.132508059453852 43.80583267544348, 7.129779512268784 43.804026685766246, 7.130376897002153 43.80117182625622, 7.131723785221319 43.7995987584583, 7.133171646342537 43.792405197542514, 7.132984561311719 43.791108388613395, 7.131101319503488 43.790593219838435, 7.128397059872921 43.786392080093734, 7.120841227128459 43.782826965738494, 7.116682436897729 43.78262383360899, 7.110947262333871 43.77945510151515, 7.110095692315183 43.78003060766261, 7.110332446370174 43.78093627893948, 7.106921127225294 43.78298071758407, 7.100996697340179 43.78200285243255, 7.09885211263896 43.78236113561759, 7.09302064691738 43.78075039017178, 7.088592602047049 43.781107777236116, 7.08745121592023 43.777164261316855, 7.078802715600733 43.77422851336281, 7.07312263017455 43.768456285300864, 7.073056795645448 43.7670260589432, 7.074017383059734 43.76651255150596, 7.075341255480004 43.76328134824509, 7.074763994612074 43.761095360277295, 7.062198824126931 43.75355556132592, 7.057204376166366 43.75241912115444, 7.056031350470321 43.75107523604697, 7.052929137378397 43.749694176149035, 7.053108869954226 43.74800343912708, 7.051869528588327 43.74689625968575, 7.052960741979969 43.74568517706141, 7.052714789728484 43.74305610025541, 7.055808583995931 43.741817241547174, 7.057732895288951 43.7397388906848, 7.0597438610045 43.74066944087044, 7.067162166409786 43.73929044437892, 7.065712973497862 43.73795970178924, 7.067090158082697 43.735551110711775, 7.068770834594961 43.7351224520792, 7.07184833427312 43.730156117469825, 7.076291671835544 43.727469512949675, 7.079138464735706 43.72437044839617, 7.079075613256979 43.7171978335743, 7.079933608124349 43.71325425699467, 7.078928442785075 43.71178723146551, 7.078472379865357 43.707619041477386, 7.080403568001612 43.703992035051776, 7.085470770801999 43.703293602728884, 7.088563741493716 43.70192582277265, 7.092898626718551 43.70309538330841, 7.096932635848439 43.705888976059136, 7.102352248691874 43.70690107639972, 7.110742628511533 43.7119689256135, 7.116340558099085 43.712322161173695, 7.117942750379591 43.71152444569316, 7.119752968643086 43.712305587570675, 7.122255565313195 43.71091954487317, 7.121900546979819 43.70957780946262, 7.122798248141492 43.70843458017393, 7.125230054013036 43.707620615891955, 7.125068499341984 43.706378778776156, 7.127381212005836 43.70646403172357, 7.130317553527237 43.70420982768807, 7.132554332228656 43.698858157555335, 7.132210807041454 43.69754035182352, 7.134218457188553 43.69485097066093, 7.143564605662394 43.69162531484672, 7.139147625065673 43.690475317449504, 7.140447100586123 43.689178773581304, 7.133338474478139 43.684229481870226, 7.132534474489868 43.682173221178445, 7.135256094618211 43.681005582764584, 7.131610086041744 43.67963497081414, 7.132838130886822 43.674855999617925, 7.12759093585342 43.67339567440822, 7.124043841962174 43.67376819526701, 7.123441660337692 43.672732324106846, 7.120807988306593 43.67253216467579, 7.120650190875375 43.671684867725425, 7.124070745686622 43.66431712337969, 7.13111364361388 43.658524478128186, 7.13454013878185 43.6575606982345, 7.130248993213394 43.65388280053781, 7.129804891949093 43.652921164257926, 7.130517449726934 43.65187501472243, 7.134379236170694 43.65063788640346, 7.133156179690797 43.64937162222666, 7.136440971639024 43.64956377220786, 7.14429323621731 43.64311497865796, 7.146124715850558 43.6419341209769, 7.145608543257555 43.64390545520176, 7.151020597596671 43.64940055256143, 7.15567864385999 43.65180937235497, 7.154865097005479 43.65209007543717, 7.155278787177323 43.65274643287589, 7.156120619562264 43.651692450537574, 7.156373226180417 43.65204410573166, 7.156097055730724 43.6528214585706, 7.157818814741423 43.653837739303306, 7.167769536659652 43.6574094113338, 7.172255479304168 43.65670382647778, 7.170765754026864 43.65659522550391, 7.171071417182109 43.65573109413901, 7.173321285779358 43.65625742024317, 7.175806426381746 43.655414062659155, 7.17613550452878 43.65606369246016, 7.177932087104345 43.656176640128415, 7.180462844248922 43.655125977679994, 7.180491990389872 43.656239468023564, 7.18308470977579 43.65687044403888, 7.183786087176249 43.655768471939226, 7.183617912732688 43.656966152404465, 7.185303316372383 43.65713642350756, 7.185568083128387 43.65576651919226, 7.178716977380733 43.65461916190028, 7.179552440267168 43.65429958927322, 7.181871664131453 43.65438155119221, 7.187320443228929 43.65576658042198, 7.186214121171461 43.65601375191622, 7.18630293553911 43.65716098941964, 7.187285823146629 43.65751688202046, 7.189179898587039 43.65689152018013, 7.189327548906022 43.65746791656323, 7.191494019422692 43.65771595847344, 7.192209983492378 43.657103544015804, 7.194355625604026 43.657728078588846, 7.198672365618457 43.65558080244908, 7.200180017426849 43.659013289887945, 7.197845025531572 43.663274595784635, 7.200009565829381 43.6641019461264, 7.201688346963467 43.65857832603445, 7.200866613554226 43.65344965333912, 7.203610972177956 43.651224186809685, 7.199680219743147 43.647661096684786, 7.199539061971098 43.646683489490755, 7.201014551183818 43.6455343486052, 7.20261099496074 43.645510445479374, 7.206866154761404 43.64597109029461, 7.207145524356918 43.64690279166591, 7.209217515522402 43.64808132918556, 7.212630367387573 43.64774900547315, 7.214457135808822 43.650399406502935, 7.221336122528879 43.65574248531363, 7.220346128975478 43.656791961235044, 7.221943032997262 43.65737600145058, 7.220316310828852 43.65839164561455, 7.223772694838853 43.66081283060443, 7.223617467403018 43.659616811089094, 7.221625793632954 43.658274997098516, 7.223250127927463 43.65719364583416, 7.222758498117112 43.657747098364965, 7.22545038687324 43.659865436364804, 7.225933558331582 43.66230932875506, 7.230681423436567 43.66582357933401, 7.229117867475614 43.669208586999005, 7.229911583393881 43.671349346111434, 7.229447001978296 43.67349672702552, 7.231412113871231 43.6760820948084, 7.230571660843546 43.67853607793454, 7.233365366332372 43.68189656830592, 7.240240493543761 43.68748042913464, 7.250650477214921 43.69188047597427, 7.263328804555893 43.69431361499139, 7.277031909267949 43.69435573393836, 7.278966456404808 43.69323698856304, 7.285626191951379 43.69226456250359, 7.288353955552124 43.6904312999659, 7.283308833292748 43.69447268127989, 7.284353251680005 43.695334478422005, 7.283678289145015 43.695642232436526, 7.284183058883965 43.69818791344917, 7.286100119015254 43.698013231394306, 7.285018030730701 43.69538848178388, 7.285673773988219 43.69464171630619, 7.285354913847256 43.693634185844125, 7.288708970350823 43.69332980706679, 7.28843299244897 43.69198356348361, 7.289494646993036 43.69292573467577, 7.289858347440905 43.69197869421736, 7.288790038279253 43.6918757592054, 7.289419979621401 43.691332745682715, 7.29049391223904 43.6922563994498, 7.293636721954392 43.6907265255715, 7.294398380760881 43.68889413933044, 7.293461753959492 43.687383862209586, 7.293807018450747 43.68650692463973, 7.295456869798135 43.685507251679724, 7.297538811317188 43.68659195230111, 7.30011720943679 43.68639897057567, 7.303347513060563 43.685891752172346, 7.304255094327243 43.68501414083416, 7.306073267916851 43.68579282195213, 7.308060767357964 43.68842475453217, 7.309012929271704 43.69246206295558, 7.307596808217713 43.694504342284404, 7.307289168087343 43.69677033790213, 7.308710435375881 43.697468296251174, 7.310674131722435 43.699364912256584, 7.310205070284104 43.69937089162914, 7.30849256690028 43.697626523373735, 7.307608148390987 43.69762552069158, 7.307109750970055 43.69687837599787, 7.306828644952682 43.698143930835755, 7.308610429465554 43.699324152985355, 7.309183851366516 43.698889595450275, 7.308795783223662 43.6993114006974, 7.311702413559042 43.701110253936086, 7.312834234630047 43.70302540946459, 7.311999753474588 43.70279806720943, 7.313134067540902 43.705932409897336, 7.314556147132355 43.7067194919064, 7.318139114406261 43.706163629774956, 7.320267479471006 43.704671452336015, 7.320493707451858 43.70396585491314, 7.319690646051678 43.70353005108904, 7.320401332186286 43.70292326101559, 7.319807936106241 43.70259898404817, 7.320867605593446 43.702271207188645, 7.321333796284272 43.70000605281756, 7.323619747748359 43.70078480890137, 7.325348052802098 43.70013390906682, 7.324985678852035 43.698708245599065, 7.326689614733043 43.69671734257321, 7.326629789089123 43.695630203186354, 7.324557539429692 43.69552430582499, 7.324513933194648 43.69476635172302, 7.324771406874134 43.69463985854533, 7.324642539475548 43.694183584514505, 7.325084199171684 43.69388124441021, 7.324914232373726 43.693456344641135, 7.320522667534797 43.691466352800994, 7.320541176219295 43.68820699699845, 7.321319160015365 43.68706313288054, 7.322644526778062 43.68724834553094, 7.323592190128004 43.68511274116169, 7.322792894565998 43.68432897563189, 7.325095951178336 43.68197273233507, 7.323933929275448 43.68054556101683, 7.324591722888991 43.68016343129173, 7.324406379484571 43.67716722982567, 7.326377638176653 43.67451596087392, 7.331925785363756 43.67483836057518, 7.333749139961032 43.67565151503603, 7.335376960388043 43.67848925759749, 7.334878232519009 43.686382686562624, 7.337569140688545 43.68629877452356, 7.3380890596322 43.683884505360744, 7.338642224262744 43.68607120852893, 7.339919707039925 43.68613195836115, 7.342165466450627 43.682782714326926, 7.342097159198989 43.68338833016627, 7.349808564238163 43.68672168657022, 7.347010933209116 43.68754283018103, 7.343345573958734 43.68606181346017, 7.34192898002191 43.68624637388926, 7.340561002624508 43.68766178571349, 7.338862364056345 43.687648492947694, 7.335604527805564 43.69190586660854, 7.335352296282909 43.69105169658065, 7.337009648267832 43.689469808469006, 7.336288816856181 43.689003818391306, 7.336091985151427 43.68965150509886, 7.335941807390079 43.688996932869316, 7.336856439637661 43.68880814868856, 7.33651161254959 43.68822352395107, 7.334818551700108 43.68834962706157, 7.335502466014234 43.68893515226668, 7.33440664940867 43.68945377001029, 7.335408360142761 43.68995543212093, 7.334683394873283 43.690664730023556, 7.335088869137088 43.68985282267917, 7.334104985930647 43.68983257593608, 7.333989313474465 43.691109647979815, 7.334862161256617 43.69109016659758, 7.333724828690301 43.69265219205771, 7.334286047968919 43.69399510272134, 7.332592121925083 43.695867681585064, 7.334301875905029 43.69645108543966, 7.333855359796771 43.6967545593804, 7.331466681458579 43.69703088740771, 7.330004419928646 43.69927539159636, 7.33059173533162 43.700569524514194, 7.329575229920958 43.70200863725853, 7.330782354479113 43.703269078918154, 7.331882721640016 43.703233357045946, 7.331427419299938 43.70374984878584, 7.331992124944097 43.70400581770251, 7.333488144127704 43.70345325858811, 7.332105503712487 43.70299287745065, 7.334105622038902 43.70297895716754, 7.334841865798261 43.70454830886234, 7.336149716772574 43.70516844689261, 7.337310963949774 43.70685331360244, 7.336425063196424 43.7070643775162, 7.336899948062183 43.707773598366956, 7.335606614807318 43.70808381303575, 7.335773667162714 43.70691101627442, 7.334738756758767 43.707500197507784, 7.335397777300132 43.70893474962692, 7.337260577057591 43.708630664168844, 7.335438298599357 43.70902685764435, 7.336204781715234 43.710698642116846, 7.338906271388581 43.71005107497786, 7.33741326666439 43.707481866949934, 7.337962316655013 43.707333798865044, 7.339316796476374 43.710222142093116, 7.337606689448429 43.71126275182877, 7.338080050018776 43.71204953470621, 7.339791754460536 43.71202900323483, 7.342484677350742 43.713838345362895, 7.344569508987443 43.71365864972219, 7.350816198668764 43.71515814807553, 7.351833830060318 43.71698832790616, 7.350573670122462 43.716690880809395, 7.351727961716161 43.71858589143299, 7.359950663872208 43.72260671226219, 7.364712232884145 43.72206606835267, 7.367222311556777 43.72019352277241, 7.374822518179464 43.71768099519901, 7.375244048592426 43.719212331469315, 7.381169147607952 43.721587360123536, 7.381847804534353 43.722530639910836, 7.389151177067482 43.72329510820138, 7.390577411939137 43.72167120624195, 7.388847273810163 43.719933170084836, 7.389035627031038 43.719262265533274, 7.393588568329777 43.72029870077965, 7.395520688564879 43.71921305495784, 7.398650213451638 43.719674134025844, 7.399007444545039 43.71890625402696, 7.400007805383281 43.72089446743929, 7.401008652140328 43.721208159111114, 7.406305241073661 43.71874511503974, 7.406763925334302 43.71923122429902, 7.405711528365527 43.71991013534834, 7.41035911410859 43.72179823050293, 7.411793832940464 43.72332172645422, 7.410984209594889 43.72366819656552, 7.41181530387136 43.72451861009206, 7.413185112615412 43.72494160149589, 7.415777125005675 43.72397120431791, 7.414101518957959 43.72514144333657, 7.415297999089695 43.726071636318046, 7.417987990957182 43.72469615303328, 7.415132570622197 43.72325203916862, 7.41659653846662 43.723349419389145, 7.418514137529072 43.72475048549627, 7.409100248169143 43.72955310635446, 7.410919737585587 43.73127733143567, 7.41248321254425 43.73159875677341)), ((7.36671041100748 43.71996624242221, 7.367577415059418 43.71918071793739, 7.367757896321264 43.71931496070642, 7.36721839795073 43.720158532555544, 7.36671041100748 43.71996624242221)), ((7.19138047815288 43.65628313513077, 7.192448467995937 43.6562923916785, 7.192664612800922 43.65641380531461, 7.191419624736174 43.656377138182734, 7.19138047815288 43.65628313513077)), ((7.188559609885911 43.65609726561055, 7.189246447171253 43.6560536660301, 7.189796389015744 43.6562424096781, 7.189633884538665 43.65626038970168, 7.188559609885911 43.65609726561055)), ((7.19407971948387 43.6563330603057, 7.195094798763584 43.65631459796266, 7.195275165650206 43.65640494947651, 7.19409439489758 43.656448731746, 7.19407971948387 43.6563330603057)), ((7.190188379205321 43.656630070398094, 7.1908602934257 43.65656901495675, 7.190981865772767 43.656703991249714, 7.190286556179466 43.656750631494305, 7.190188379205321 43.656630070398094)), ((7.193089770445535 43.65688127277367, 7.193139109729238 43.65674150520535, 7.193770479136407 43.656821662090245, 7.19362555972705 43.656927274112, 7.193089770445535 43.65688127277367)), ((7.187610227398762 43.65638615776845, 7.187833856759253 43.65630455247785, 7.18822729323495 43.65642364648156, 7.187685793712348 43.656503087061644, 7.187610227398762 43.65638615776845)))'
    poly_mnca = shapely.wkt.loads(poly_mnca)
    
    df_res = pd.DataFrame()
    for grp in list_grp:
        grp = str(grp)
        dic_cat = {'17': 'Aidant numérique', '18': 'Médiation numérique', '19': 'Formation numérique',
                   '20': 'Connexion', '21': 'Reconditionneur'}
        
        response = requests.get(f'https://inclusionnumerique06v2.gogocarto.fr/api/elements.json?categories={grp}') 
        
        
        
        data = response.json()
        data = data['data']
        
        
        
        df = pd.DataFrame(columns=['Nom', 'Num groupe', 'Groupe', 'Categorie', 'Latitude', 'Longitude'])
        num_grp = grp
        grp = dic_cat[grp]
            
        #dic_error = {'nom': 'name', 'cp': 'postalCode', 'adresse': 'fullAddress'}
        
        for i in range(len(data)):
            dic = data[i]
            try:
                nom = dic['name']
                cat = dic['categories']
                new_cat = []
                for k in cat:
                    if 'Groupe' not in k:
                        new_cat.append(k)
                
                new_cat = "; ".join(new_cat)
                lat = dic['geo']['latitude']
                long = dic['geo']['longitude']
                    
            except KeyError as ke:
                print(ke)
            
            df.loc[i] = [nom, num_grp, grp, new_cat, lat, long]
            
            
        list_coord = []
        list_point = []
        points_mnca = []
        for i in range(len(df)): 
            lat = df['Latitude'][i]
            long = df['Longitude'][i]
            coord = [lat, long]
            point = Point([long, lat])
            
            if poly_mnca.contains(point):
                points_mnca.append(True)
            else:
                points_mnca.append(False)
                
            list_coord.append(coord)
            list_point.append(point)
            
            
        df['Coord'] = list_coord
        df['Point'] = list_point
        df['MNCA'] = points_mnca
        
        df_res = pd.concat([df_res, df])
    
    df_res.reset_index(drop=True, inplace=True)
    
    return(df_res)


